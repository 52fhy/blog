#### nethogs

```
nethogs可以通过进程来查看网速的状态,特别是当服务器出现流量突然很高的时候,可以用它来查看哪一个进程占用了带宽.
必须使用root来启动.

#nethogs eth0

  PID USER     PROGRAM                                                                                            DEV        SENT      RECEIVED
7769  rocky    wget                                            em1       12.371     596.740 KB/sec
3395  root     openvpn                                         em1        0.753	 0.462 KB/sec
2096  qfpay    nginx: worker process                           em1        0.154	 0.402 KB/sec
7598  rocky    sshd: rocky@pts/21                              em1        0.935	 0.232 KB/sec
7426  rocky    sshd: rocky@pts/13                              em1        1.084	 0.114 KB/sec
2847  rocky    sshd: rocky@pts/12                              em1        0.000	 0.000 KB/sec
2597  rocky    sshd: rocky@pts/2                               em1        0.000	 0.000 KB/sec
31603 rocky    sshd: rocky@pts/18                              em1        0.000	 0.000 KB/sec
3710  qfpay    nginx: worker process                           em1        0.000	 0.000 KB/sec
29907 qfpay    nginx: worker process is shutting down          em1        0.000	 0.000 KB/sec
23322 hesen    python                                          em1        0.000	 0.000 KB/sec
?     root     unknown TCP                                                0.000	 0.000 KB/sec

TOTAL                                                                  15.297     597.949 KB/sec

可以很方便地看出来占带宽的进程是rocky用户的wget命令,而且很明显看出PID.太好用了.

```

#### iftop

```
当然iftop也是挺好用的,可以通过IP+port的方式来查看网速.可以精确查看某一个连接的上传下载网速,而且可以看到2秒,10秒,40秒的平均网速
如下,左边的1,2,3,4代表不同的网络连接,每一个连接的上面为上传,下面那个为下载,而且默认是按照网速从大到小排序的,可以看到第一个连接的10秒内的
平均下载速度为245KB,也可以看到过去10秒内总的平均下载网速246K.

#iftop
============================================================================================

   # Host name (port/service if enabled)            last 2s   last 10s   last 40s cumulative
--------------------------------------------------------------------------------------------
   1 172.100.102.101:43641                    =>         0B     5.29KB     7.23KB      455KB
     115.28.122.210:80                        <=         0B      245KB      354KB     22.0MB
   2 172.100.102.101:22                       =>     1.42KB     1.44KB     1.44KB      106KB
     172.100.108.203:50857                    <=        26B        42B        40B     2.92KB
   3 172.100.102.101:53479                    =>     1.62KB       898B     2.35KB      110KB
     223.202.100.7:5194                       <=       908B       511B     34.2KB     1.35MB
   4 172.100.102.101:22                       =>         0B       864B     1.02KB     59.9KB
     172.100.108.203:50990                    <=         0B       186B       218B     12.8KB
   5 172.100.102.101:8182                     =>         0B        38B        17B       997B
     172.100.108.162:54173                    <=         0B       192B        72B     3.79KB
   6 172.100.102.101:8182                     =>       145B        58B        29B     1.70KB
     172.100.114.58:50374                     <=       425B       168B        84B     4.93KB
   7 172.100.102.101:8182                     =>       157B        31B        16B       942B
     172.100.108.60:56588                     <=       462B        92B        46B     2.71KB
   8 172.100.102.101:8182                     =>         0B        29B        36B     2.55KB
     172.100.122.84:54601                     <=         0B        89B       109B     7.68KB
   9 172.100.102.101:34472                    =>         0B        27B         7B       274B
     172.100.102.163:27018                    <=         0B        58B        15B       584B
  10 172.100.102.101:51392                    =>         0B        27B         7B       274B
     172.100.102.163:27019                    <=         0B        58B        15B       584B
--------------------------------------------------------------------------------------------
Total send rate:                                     3.33KB     8.71KB     44.1KB
Total receive rate:                                  1.78KB      246KB      389KB
Total send and receive rate:                         5.11KB      255KB      434KB
--------------------------------------------------------------------------------------------
Peak rate (sent/received/total):                      588KB      920KB     1.47MB
Cumulative (sent/received/total):                    1.97MB     23.4MB     25.4MB
============================================================================================

```
