#### 背景介绍

&emsp;工作中经常遇到这样的问题, Linux的磁盘空间有报警了, 但是登录到那个机器上使用`du`查看后, 未发现哪个目录占用了空间, 但是使用`df -h`的时候确实磁盘已经快满了.

#### 解决办法

这个deleted表示该已经删除了的文件，但是文件句柄未释放,这个命令会把所有的未释放文件句柄的进程列出来

```
lsof |grep deleted
nginx  1312    root    8w      REG              252,1     59890     393606 /var/log/nginx.log (deleted)
```

这个时候可以把这个进程重启一下就行了, 从图中可以看到这个进程的pid为1312. 一般出现该问题的场景是, 这个文件正在被使用的时候(比如tail或者写数据等)被删除了.

#### 结论

* 遇到这个情况可以重启一下占用该文件的进程
* 遇到清空大文件的时候, 尽量使用`echo '' > test.txt`